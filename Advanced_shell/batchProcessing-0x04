#!/usr/bin/env bash
set -euo pipefail
POKEMON=(bulbasaur ivysaur venusaur charmander charmeleon); mkdir -p pokemon_data_parallel; pids=(); for p in "${POKEMON[@]}"; do ( CODE=$(curl -sS -H 'User-Agent: alx-shell' -w '%{http_code}' -o "pokemon_data_parallel/$p.json.tmp" "https://pokeapi.co/api/v2/pokemon/$p" || echo "000"); if [ "$CODE" = "200" ]; then mv "pokemon_data_parallel/$p.json.tmp" "pokemon_data_parallel/$p.json"; echo "Saved $p âœ…"; else echo "$(date -Is) ERROR $CODE while fetching $p" >> errors.txt; rm -f "pokemon_data_parallel/$p.json.tmp"; fi ) & pids+=($!); done; for pid in "${pids[@]}"; do wait "$pid"; done; echo "All parallel fetches complete."
